{
  "hash": "9683715b10ce1ebf5234d64c70bb9935",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Analysis of RNA-Seq Data\nauthor:\n  - name: Piero Palacios Bernuy\n    orcid: 0000-0001-6729-4080\n    corresponding: true\n    email: p.palacios.bernuy@gmail.com\n    roles:\n      - Investigation\n      - Bioinformatics\n      - Deep learning\n      - Visualization\nkeywords:\n  - RNA\n  - reads\n  - gene expression\n  - gene sets\n  - ontologies\nabstract: |\n  This document is part of a series of the analysis of Omics data. Especifycally, here is showed how to analyze bulk RNA-Seq data with Bioconductor packages. Also, it's showcased how to make plots of the rna data in the context of differentially gene expression and gene-sets. \nplain-language-summary: |\n  This document have a example of the analysis of bulk RNA-Seq data.\nkey-points:\n  - A guide to analyze bulk RNA-Seq data.\n  - A guide to gene-sets analysis.\ndate: last-modified\nbibliography: references.bib\ncitation:\n  container-title: An open source portfolio\nnumber-sections: true\n---\n\n\n\n\n## Introduction\n\nhola\n\n## Data & Methods {#sec-data-methods}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(airway)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: SummarizedExperiment\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'SummarizedExperiment' was built under R version 4.3.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: MatrixGenerics\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'MatrixGenerics' was built under R version 4.3.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: matrixStats\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'matrixStats' was built under R version 4.3.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'MatrixGenerics'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: GenomicRanges\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: stats4\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: BiocGenerics\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'BiocGenerics'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,\n    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,\n    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,\n    table, tapply, union, unique, unsplit, which.max, which.min\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: S4Vectors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'S4Vectors'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:utils':\n\n    findMatches\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: IRanges\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'IRanges'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:grDevices':\n\n    windows\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: GenomeInfoDb\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: Biobase\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'Biobase'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(DESeq2)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'DESeq2' was built under R version 4.3.1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndata(\"airway\")\n\ndds <- DESeqDataSet(se = airway, design = ~ cell + dex)\n```\n:::\n\n\n\n\npre-filtering\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nkeep <- rowSums(counts(dds)>= 10) >= 3\n\ndds <- dds[keep,]\n```\n:::\n\n\n\n\n\nre-leveling\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndds$dex <- factor(dds$dex, levels = c(\"untrt\",\"trt\"))\ndds$dex <- relevel(dds$dex, ref = \"untrt\")\ndds$dex <- droplevels(dds$dex)\n```\n:::\n\n\n\n\ndifferential gene expression\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndds <- DESeq(dds)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nestimating size factors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nestimating dispersions\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\ngene-wise dispersion estimates\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nmean-dispersion relationship\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfinal dispersion estimates\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfitting model and testing\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nres <- results(dds)\n\nres\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlog2 fold change (MLE): dex trt vs untrt \nWald test p-value: dex trt vs untrt \nDataFrame with 16596 rows and 6 columns\n                 baseMean log2FoldChange     lfcSE      stat      pvalue\n                <numeric>      <numeric> <numeric> <numeric>   <numeric>\nENSG00000000003   709.880     -0.3839261 0.1008515 -3.806846 1.40750e-04\nENSG00000000419   521.156      0.2041705 0.1116546  1.828590 6.74611e-02\nENSG00000000457   237.573      0.0352858 0.1412422  0.249825 8.02723e-01\nENSG00000000460    58.035     -0.0923157 0.2792981 -0.330527 7.41002e-01\nENSG00000000971  5826.538      0.4237405 0.0893546  4.742236 2.11372e-06\n...                   ...            ...       ...       ...         ...\nENSG00000273448  14.02944      0.0583225  0.483593  0.120603    0.904006\nENSG00000273472  11.08483     -0.4087635  0.558196 -0.732294    0.463989\nENSG00000273486  15.47814     -0.1516640  0.471121 -0.321922    0.747512\nENSG00000273487   8.17605      1.0408751  0.678127  1.534926    0.124802\nENSG00000273488   8.59778      0.1088526  0.618005  0.176136    0.860187\n                       padj\n                  <numeric>\nENSG00000000003 1.09455e-03\nENSG00000000419 1.85852e-01\nENSG00000000457 9.04035e-01\nENSG00000000460 8.71680e-01\nENSG00000000971 2.48262e-05\n...                     ...\nENSG00000273448    0.954503\nENSG00000273472    0.675274\nENSG00000273486    0.874323\nENSG00000273487    0.292586\nENSG00000273488    0.933030\n```\n\n\n:::\n:::\n\n\n\n\n\n## Conclusion\n\nhola\n\n## References {.unnumbered}\n\n:::{#refs}\n\n:::",
    "supporting": [
      "index_files\\figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}