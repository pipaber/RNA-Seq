<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>An open source portfolio</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Analysis of RNA-Seq Data</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-6729-4080</contrib-id>
<name>
<surname>Bernuy</surname>
<given-names>Piero Palacios</given-names>
</name>
<string-name>Piero Palacios Bernuy</string-name>

<email>p.palacios.bernuy@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Bioinformatics</role>
<role>Deep learning</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor-1">p.palacios.bernuy@gmail.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-02-28">
<year>2024</year>
<month>2</month>
<day>28</day>
</pub-date>







<history></history>


<abstract>
<p>This document is part of a series of the analysis of Omics data.
Especifycally, here is showed how to analyze bulk RNA-Seq data with
Bioconductor packages. Also, it’s showcased how to make plots of the rna
data in the context of differentially gene expression and gene-sets.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>RNA</kwd>
<kwd>reads</kwd>
<kwd>gene expression</kwd>
<kwd>gene sets</kwd>
<kwd>ontologies</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1 Introduction</title>
  <p>hola</p>
</sec>
<sec id="sec-data-methods">
  <title>2 Data &amp; Methods</title>
  <p>pre-filtering</p>
  <p>re-leveling</p>
  <p>differential gene expression</p>
  <preformat>log2 fold change (MLE): dex trt vs untrt 
Wald test p-value: dex trt vs untrt 
DataFrame with 16596 rows and 6 columns
                 baseMean log2FoldChange     lfcSE      stat      pvalue
                &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;
ENSG00000000003   709.880     -0.3839261 0.1008515 -3.806846 1.40750e-04
ENSG00000000419   521.156      0.2041705 0.1116546  1.828590 6.74611e-02
ENSG00000000457   237.573      0.0352858 0.1412422  0.249825 8.02723e-01
ENSG00000000460    58.035     -0.0923157 0.2792981 -0.330527 7.41002e-01
ENSG00000000971  5826.538      0.4237405 0.0893546  4.742236 2.11372e-06
...                   ...            ...       ...       ...         ...
ENSG00000273448  14.02944      0.0583225  0.483593  0.120603    0.904006
ENSG00000273472  11.08483     -0.4087635  0.558196 -0.732294    0.463989
ENSG00000273486  15.47814     -0.1516640  0.471121 -0.321922    0.747512
ENSG00000273487   8.17605      1.0408751  0.678127  1.534926    0.124802
ENSG00000273488   8.59778      0.1088526  0.618005  0.176136    0.860187
                       padj
                  &lt;numeric&gt;
ENSG00000000003 1.09455e-03
ENSG00000000419 1.85852e-01
ENSG00000000457 9.04035e-01
ENSG00000000460 8.71680e-01
ENSG00000000971 2.48262e-05
...                     ...
ENSG00000273448    0.954503
ENSG00000273472    0.675274
ENSG00000273486    0.874323
ENSG00000273487    0.292586
ENSG00000273488    0.933030</preformat>
</sec>
<sec id="conclusion">
  <title>3 Conclusion</title>
  <p>hola</p>
</sec>
<sec id="references">
  <title>References</title>
</sec>
</body>

<back>
</back>

<sub-article article-type="notebook" id="nb-8-nb-article">
<front-stub>
<title-group>
<article-title>Analysis of RNA-Seq Data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-6729-4080</contrib-id>
<name>
<surname>Bernuy</surname>
<given-names>Piero Palacios</given-names>
</name>
<string-name>Piero Palacios Bernuy</string-name>

<email>p.palacios.bernuy@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Bioinformatics</role>
<role>Deep learning</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor-1-nb-article">p.palacios.bernuy@gmail.com</corresp>
</author-notes>
<abstract>
<p>This document is part of a series of the analysis of Omics data.
Especifycally, here is showed how to analyze bulk RNA-Seq data with
Bioconductor packages. Also, it’s showcased how to make plots of the rna
data in the context of differentially gene expression and gene-sets.</p>
</abstract>
</front-stub>

<body>
<sec id="introduction-nb-article">
  <title>1 Introduction</title>
  <p>hola</p>
</sec>
<sec id="sec-data-methods-nb-article">
  <title>2 Data &amp; Methods</title>
  <sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
  <code language="r script">library(airway)</code>
  <code language="r script">library(DESeq2)</code>
  <code language="r script">data(&quot;airway&quot;)

dds &lt;- DESeqDataSet(se = airway, design = ~ cell + dex)</code>
  <sec id="nb-code-cell-1-output-0-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: SummarizedExperiment</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-1-nb-article" specific-use="notebook-output">
  <preformat>Warning: package 'SummarizedExperiment' was built under R version 4.3.1</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-2-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: MatrixGenerics</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-3-nb-article" specific-use="notebook-output">
  <preformat>Warning: package 'MatrixGenerics' was built under R version 4.3.1</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-4-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: matrixStats</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-5-nb-article" specific-use="notebook-output">
  <preformat>Warning: package 'matrixStats' was built under R version 4.3.1</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-6-nb-article" specific-use="notebook-output">
  <preformat>
Attaching package: 'MatrixGenerics'</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-7-nb-article" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-8-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: GenomicRanges</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-9-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: stats4</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-10-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: BiocGenerics</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-11-nb-article" specific-use="notebook-output">
  <preformat>
Attaching package: 'BiocGenerics'</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-12-nb-article" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-13-nb-article" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-14-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: S4Vectors</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-15-nb-article" specific-use="notebook-output">
  <preformat>
Attaching package: 'S4Vectors'</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-16-nb-article" specific-use="notebook-output">
  <preformat>The following object is masked from 'package:utils':

    findMatches</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-17-nb-article" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:base':

    expand.grid, I, unname</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-18-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: IRanges</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-19-nb-article" specific-use="notebook-output">
  <preformat>
Attaching package: 'IRanges'</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-20-nb-article" specific-use="notebook-output">
  <preformat>The following object is masked from 'package:grDevices':

    windows</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-21-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: GenomeInfoDb</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-22-nb-article" specific-use="notebook-output">
  <preformat>Loading required package: Biobase</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-23-nb-article" specific-use="notebook-output">
  <preformat>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation(&quot;Biobase&quot;)', and for packages 'citation(&quot;pkgname&quot;)'.</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-24-nb-article" specific-use="notebook-output">
  <preformat>
Attaching package: 'Biobase'</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-25-nb-article" specific-use="notebook-output">
  <preformat>The following object is masked from 'package:MatrixGenerics':

    rowMedians</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-26-nb-article" specific-use="notebook-output">
  <preformat>The following objects are masked from 'package:matrixStats':

    anyMissing, rowMedians</preformat>
  </sec>
  <sec id="nb-code-cell-1-output-27-nb-article" specific-use="notebook-output">
  <preformat>Warning: package 'DESeq2' was built under R version 4.3.1</preformat>
  </sec>
  </sec>
  <p>pre-filtering</p>
  <sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
  <code language="r script">keep &lt;- rowSums(counts(dds)&gt;= 10) &gt;= 3

dds &lt;- dds[keep,]</code>
  </sec>
  <p>re-leveling</p>
  <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
  <code language="r script">dds$dex &lt;- factor(dds$dex, levels = c(&quot;untrt&quot;,&quot;trt&quot;))
dds$dex &lt;- relevel(dds$dex, ref = &quot;untrt&quot;)
dds$dex &lt;- droplevels(dds$dex)</code>
  </sec>
  <p>differential gene expression</p>
  <sec id="nb-code-cell-4-nb-article" specific-use="notebook-code">
  <code language="r script">dds &lt;- DESeq(dds)</code>
  <code language="r script">res &lt;- results(dds)

res</code>
  <sec id="nb-code-cell-4-output-0-nb-article" specific-use="notebook-output">
  <preformat>estimating size factors</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-1-nb-article" specific-use="notebook-output">
  <preformat>estimating dispersions</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-2-nb-article" specific-use="notebook-output">
  <preformat>gene-wise dispersion estimates</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-3-nb-article" specific-use="notebook-output">
  <preformat>mean-dispersion relationship</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-4-nb-article" specific-use="notebook-output">
  <preformat>final dispersion estimates</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-5-nb-article" specific-use="notebook-output">
  <preformat>fitting model and testing</preformat>
  </sec>
  <sec id="nb-code-cell-4-output-6-nb-article" specific-use="notebook-output">
  <preformat>log2 fold change (MLE): dex trt vs untrt 
Wald test p-value: dex trt vs untrt 
DataFrame with 16596 rows and 6 columns
                 baseMean log2FoldChange     lfcSE      stat      pvalue
                &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;
ENSG00000000003   709.880     -0.3839261 0.1008515 -3.806846 1.40750e-04
ENSG00000000419   521.156      0.2041705 0.1116546  1.828590 6.74611e-02
ENSG00000000457   237.573      0.0352858 0.1412422  0.249825 8.02723e-01
ENSG00000000460    58.035     -0.0923157 0.2792981 -0.330527 7.41002e-01
ENSG00000000971  5826.538      0.4237405 0.0893546  4.742236 2.11372e-06
...                   ...            ...       ...       ...         ...
ENSG00000273448  14.02944      0.0583225  0.483593  0.120603    0.904006
ENSG00000273472  11.08483     -0.4087635  0.558196 -0.732294    0.463989
ENSG00000273486  15.47814     -0.1516640  0.471121 -0.321922    0.747512
ENSG00000273487   8.17605      1.0408751  0.678127  1.534926    0.124802
ENSG00000273488   8.59778      0.1088526  0.618005  0.176136    0.860187
                       padj
                  &lt;numeric&gt;
ENSG00000000003 1.09455e-03
ENSG00000000419 1.85852e-01
ENSG00000000457 9.04035e-01
ENSG00000000460 8.71680e-01
ENSG00000000971 2.48262e-05
...                     ...
ENSG00000273448    0.954503
ENSG00000273472    0.675274
ENSG00000273486    0.874323
ENSG00000273487    0.292586
ENSG00000273488    0.933030</preformat>
  </sec>
  </sec>
</sec>
<sec id="conclusion-nb-article">
  <title>3 Conclusion</title>
  <p>hola</p>
</sec>
<sec id="references-nb-article">
  <title>References</title>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Explore Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-1" specific-use="notebook-code">
<code language="r script">library(tidyverse)
</code>
<sec id="nb-code-cell-1-output-0-nb-1" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
</sec>
<p>Read a clean version of data:</p>
<sec id="nb-code-cell-2-nb-1" specific-use="notebook-code">
<code language="r script">la_palma &lt;- read_csv(&quot;la-palma.csv&quot;)
</code>
<sec id="nb-code-cell-2-output-0-nb-1" specific-use="notebook-output">
<preformat>Rows: 11347 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
dbl  (4): Longitude, Latitude, Depth(km), Magnitude
dttm (1): DateTime

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
</sec>
</sec>
<p>Create spatial plot:</p>
<sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-code">
<code language="r script">#|   against longitude.&quot;
la_palma |&gt; 
  ggplot(aes(Longitude, Latitude)) +
  geom_point(aes(color = Magnitude, size = 40-`Depth(km)`)) +
  scale_color_viridis_c(direction = -1) + 
  scale_size(range = c(0.5, 2), guide = &quot;none&quot;) +
  theme_bw()
</code>
<fig id="fig-spatial-plot-nb-1">
  <caption><p>Locations of earthquakes on La Palma since
  2017</p></caption>
  <graphic mimetype="image" mime-subtype="png" xlink:href="explore-earthquakes_files/figure-jats/fig-spatial-plot-1.png" />
</fig>
</sec>
</body>



<back>
</back>


</sub-article>

</article>